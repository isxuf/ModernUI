[
  {
    "Id": "1020411",
    "ThreadId": "437831",
    "Html": "If you want to save the theme and / or the state of the window follows:<br />\nThe code has yet to be reviewed and does not have good practices, more work.<br />\n<br />\nGet this code : <a href=\"https://skydrive.live.com/redir?resid=C9AEB0D559F2832F!560\" rel=\"nofollow\">PresentationEx</a><br />\nModify and use any way you want.<br />\n<br />\nadd something like this to store the theme:<br />\n<pre><code>public class AppearanceStorageServices : IApplicationLifetimeStorageService\n    {\n        public void Store()\n        {\n            ISettingsProvider service = new SettingsProvider();\n\n            var settings = new AppearanceData();\n\n            service.SaveSettings(settings);\n        }\n\n        public void Restore()\n        {\n            ISettingsProvider service = new SettingsProvider();\n            service.TryGetSettings&lt;AppearanceData&gt;(res =&gt;\n            {\n                AppearanceManager.AccentColor = res.CurrentAccentColor;\n                AppearanceManager.FontSize = res.CurrentFontSize;\n                AppearanceManager.Theme = res.CurrentTheme;\n            }, true);\n        }\n\n        public RestoreEventTriggerMode RestoreEvent\n        {\n            get { return RestoreEventTriggerMode.OnMainWindowInitialized; }\n        }\n\n        public StoreEventTriggerMode StoreEvent\n        {\n            get { return StoreEventTriggerMode.OnNotifyChanges; }\n        }\n\n        public System.Windows.Window MainWindow { get; set; }\n\n        public class AppearanceData\n        {\n            public AppearanceData()\n            {\n                this.CurrentTheme = AppearanceManager.Theme;\n                this.CurrentFontSize = AppearanceManager.FontSize;\n                this.CurrentAccentColor = AppearanceManager.AccentColor;\n            }\n\n            [DefaultValue(Theme.Light)]\n            public Theme CurrentTheme { get; set; }\n\n            [DefaultValue(FontSize.Large)]\n            public FontSize CurrentFontSize { get; set; }\n\n            public System.Windows.Media.Color CurrentAccentColor { get; set; }\n        }\n    }</code></pre>\n\nIn App.xaml.cs set this:<br />\n<pre><code>private ApplicationStorageServices _storageService;\n\nprotected override void OnStartup(StartupEventArgs e)\n        {\n            base.OnStartup(e);\n\n            _storageService = new ApplicationStorageServices(new WindowStateStorageService(), new AppearanceStorageServices());\n        }</code></pre>\n\nIn MainWindow.xaml.cs before &quot;InitializeComponent&quot;<br />\n<pre><code>ApplicationStorageServices.Current.RegisterMainWindow(this);</code></pre>\n\nFinally on SettingsAppearanceViewModel.cs to call changes trigger to store:<br />\n<br />\nWithin &quot;OnThemeChanged&quot; at end:<br />\n<pre><code>ApplicationStorageServices.Current.NotifyChanges&lt;AppearanceStorageServices&gt;();</code></pre>\n\nWithin &quot;SelectedTheme set&quot;:<br />\n<pre><code>ApplicationStorageServices.Current.NotifyChanges&lt;AppearanceStorageServices&gt;();</code></pre>\n\nWithin &quot;SelectedFontSize set&quot;:<br />\n<pre><code>ApplicationStorageServices.Current.NotifyChanges&lt;AppearanceStorageServices&gt;();</code></pre>\n\nWithin &quot;SelectedAccentColor set&quot;:<br />\n<pre><code>ApplicationStorageServices.Current.NotifyChanges&lt;AppearanceStorageServices&gt;();</code></pre>\n\nThe IsolatedSettings helper is provided by: <a href=\"https://github.com/JakeGinnivan/SettingsProvider.net\" rel=\"nofollow\">SettingsProvider.NET</a> thank you very much.<br />\n",
    "PostedDate": "2013-03-24T15:36:39.333-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]