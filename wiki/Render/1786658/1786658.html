<div class="wikidoc"><h1>MUI has moved to GitHub</h1>Go to <b><a href="https://github.com/firstfloorsoftware/mui">GitHub</a></b>. This documentation is no longer maintained<br />
<h1>My first Modern UI app</h1>
Creating a Modern UI app manually from scratch. For a step-by-step tutorial on creating a Modern UI app using project and item templates see <a href="https://mui.codeplex.com/wikipage?title=My%20first%20Modern%20UI%20app%20using%20templates&referringTitle=My%20first%20Modern%20UI%20app">My first Modern UI app using templates</a><br /><br />1) Get the latest ModernUI release and unzip its contents to disk or install the <a href="http://nuget.org/packages/ModernUI.WPF/">ModernUI.WPF</a> package using NuGet.<br />2) Open Visual Studio and create a new WPF Application project<br />3) Add an assembly reference to <b>FirstFloor.ModernUI.dll</b> (for WPF4 projects you need to add an additional reference to <b>Microsoft.Windows.Shell.dll</b>).<br />4) Derive MainWindow from <b>ModernWindow</b><br /><br />Open MainWindow.xaml, add the ModernUI xmlns declaration and replace the Window element with mui:ModernWindow as shown below:<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">ModernWindow</span> <span style="color:Red;">x:Class</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">MuiTest.MainWindow</span><span style="color:Black;">&quot;</span>
  <span style="color:Red;">xmlns</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style="color:Black;">&quot;</span>
  <span style="color:Red;">xmlns:x</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">http://schemas.microsoft.com/winfx/2006/xaml</span><span style="color:Black;">&quot;</span>
  <span style="color:Red;">xmlns:mui</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">http://firstfloorsoftware.com/ModernUI</span><span style="color:Black;">&quot;</span>
  <span style="color:Red;">Title</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">MainWindow</span><span style="color:Black;">&quot;</span> <span style="color:Red;">Height</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">350</span><span style="color:Black;">&quot;</span> <span style="color:Red;">Width</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">525</span><span style="color:Black;">&quot;</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">ModernWindow</span><span style="color:Blue;">&gt;</span>
</pre></div>Open The MainWindow.xaml.cs, add the ModernUI using and replace the Window base class with ModernWindow.<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">using</span> FirstFloor.ModernUI.Windows.Controls;
<span style="color:Blue;">public</span> <span style="color:Blue;">partial</span> <span style="color:Blue;">class</span> MainWindow : ModernWindow {  ..  }
</pre></div>5) Open App.xaml and add the following resource dictionary references.<br /><br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">Application.Resources</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary.MergedDictionaries</span><span style="color:Blue;">&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span> <span style="color:Red;">Source</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/FirstFloor.ModernUI;component/Assets/ModernUI.xaml</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span> <span style="color:Red;">Source</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/FirstFloor.ModernUI;component/Assets/ModernUI.Light.xaml</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">ResourceDictionary.MergedDictionaries</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">ResourceDictionary</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">Application.Resources</span><span style="color:Blue;">&gt;</span>
</pre></div>Choose <b>ModernUI.Light.xaml</b> for the light theme and <b>ModernUI.Dark.xaml</b> for the dark theme. Don&#39;t supply both at the same time!<br /><br /><table><tr><td> <b>Important</b>: If you are using the <b>WPF 4.0</b> version of ModernUI you need to add an empty Rectangle style to work around a bug in WPF, as shown below. The workaround is not needed for WPF 4.5 </td></tr></table><br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">Application.Resources</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span><span style="color:Blue;">&gt;</span>
<span style="color:Green;">&lt;!-- WPF 4.0 workaround --&gt;</span>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">Style</span> <span style="color:Red;">TargetType</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">{x:Type Rectangle}</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
<span style="color:Green;">&lt;!-- end of workaround --&gt;</span>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary.MergedDictionaries</span><span style="color:Blue;">&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span> <span style="color:Red;">Source</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/FirstFloor.ModernUI;component/Assets/ModernUI.xaml</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">ResourceDictionary</span> <span style="color:Red;">Source</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/FirstFloor.ModernUI;component/Assets/ModernUI.Light.xaml</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">ResourceDictionary.MergedDictionaries</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">ResourceDictionary</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">Application.Resources</span><span style="color:Blue;">&gt;</span>
</pre></div><br />6) Compile and run the application. You should see the following window;<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mui&DownloadId=890182" alt="ModernWindow.Empty.png" title="ModernWindow.Empty.png" /><br /><br />7) Go back to MainWindow.xaml and remove the &lt;Grid&gt;&lt;/Grid content<br /><br /><b>Important</b>: the ModernWindow.Content property is ignored, all content is rendered by specifying page links as is demonstrated below.<br /><br />8) Let&#39;s define the main menu. Add the following menu link groups:<br /><br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">ModernWindow.MenuLinkGroups</span><span style="color:Blue;">&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">LinkGroup</span> <span style="color:Red;">DisplayName</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">group 1</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">&gt;</span>
    <span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">LinkGroup.Links</span><span style="color:Blue;">&gt;</span>
      <span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">Link</span> <span style="color:Red;">DisplayName</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">link 1</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
      <span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">Link</span> <span style="color:Red;">DisplayName</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">link 2</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
      <span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">Link</span> <span style="color:Red;">DisplayName</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">link 3</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
    <span style="color:Blue;">&lt;/</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">LinkGroup.Links</span><span style="color:Blue;">&gt;</span>
  <span style="color:Blue;">&lt;/</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">LinkGroup</span><span style="color:Blue;">&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">ModernWindow.MenuLinkGroups</span><span style="color:Blue;">&gt;</span>
</pre></div>9) Compile and run the application. You should see the following window;<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mui&DownloadId=890183" alt="ModernWindow.Menu.png" title="ModernWindow.Menu.png" /><br /><br />10) Let&#39;s add some actual content. Add a WPF UserControl named Page1<br /><br />11) Open Page1.xaml and add the following content<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">Grid</span> <span style="color:Red;">Style</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">{StaticResource ContentRoot}</span><span style="color:Black;">&quot;</span><span style="color:Blue;">&gt;</span>
  <span style="color:Blue;">&lt;</span><span style="color:#A31515;">TextBlock</span> <span style="color:Red;">Text</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">Hello Modern UI!</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
<span style="color:Blue;">&lt;/</span><span style="color:#A31515;">Grid</span><span style="color:Blue;">&gt;</span>
</pre></div>The ContentRoot style ensures the content is correctly positioned on screen.<br /><br />12) Go back to MainWindow.xaml and modify the first link so that it refers to Page1.xaml<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">Link</span> <span style="color:Red;">DisplayName</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">link 1</span><span style="color:Black;">&quot;</span> <span style="color:Red;">Source</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/Page1.xaml</span><span style="color:Black;">&quot;</span> <span style="color:Blue;">/&gt;</span>
</pre></div>13) Additionally add a ContentSource attribute to the ModernWindow element<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">&lt;</span><span style="color:#A31515;">mui</span><span style="color:Blue;">:</span><span style="color:#A31515;">ModernWindow</span> <span style="color:Red;">...</span>
  <span style="color:Red;">ContentSource</span><span style="color:Blue;">=</span><span style="color:Black;">&quot;</span><span style="color:Blue;">/Page1.xaml</span><span style="color:Black;">&quot;</span>
 <span style="color:Blue;">/&gt;</span>
</pre></div>The ContentSource defines the page that is loaded on start. In above case, /Page1.xaml will be loaded upon startup.<br /><br />14) Compile and run the application. You should see the following window;<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mui&DownloadId=890186" alt="ModernWindow.FirstPage.png" title="ModernWindow.FirstPage.png" /><br /><br />And that&#39;s it. You can now add additional groups and links in the MenuLinkGroups and refer to the various pages in your application. For further details on defining your MetroWindow content see the other tutorials.</div><div class="ClearBoth"></div>